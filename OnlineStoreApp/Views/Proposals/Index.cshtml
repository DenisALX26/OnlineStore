@model List<Proposal>
@{
    ViewData["Title"] = "Proposals";
}

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="fw-bold">Propuneri de produse</h1>
        @if (User.IsInRole("Colaborator"))
        {
            <a asp-action="Create" class="btn btn-primary">
                <i class="bi bi-plus-circle"></i> Propunere Nouă
            </a>
        }
    </div>

    @if (!Model.Any())
    {
        <div class="alert alert-info">
            Nu s-au găsit propuneri.
        </div>
    }
    else
    {
        <div class="card shadow-sm">
            <div class="table-responsive">
                <table class="table table-hover align-middle mb-0">
                    <thead class="table-light">
                        <tr>
                            <th>Titlu</th>
                            <th>Status</th>
                            @if (User.IsInRole("Admin"))
                            {
                                <th>Colaborator</th>
                            }
                            <th class="text-end">Acțiuni</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var proposal in Model)
                        {
                            <tr>
                                <td class="fw-semibold">
                                    @proposal.Title
                                </td>

                                <td>
                                    @switch (proposal.Status)
                                    {
                                        case ProposalStatus.Pending:
                                            <span class="badge bg-warning text-dark">@ViewBag.Statuses[(int)proposal.Status]</span>
                                            break;
                                        case ProposalStatus.Accepted:
                                            <span class="badge bg-success">@ViewBag.Statuses[(int)proposal.Status]</span>
                                            break;
                                        case ProposalStatus.Rejected:
                                            <span class="badge bg-danger">@ViewBag.Statuses[(int)proposal.Status]</span>
                                            break;
                                    }
                                </td>

                                @if (User.IsInRole("Admin"))
                                {
                                    <td>
                                        @(proposal.Username ?? "—")
                                    </td>
                                }

                                <td class="text-end">
                                    <a asp-action="Details"
                                       asp-route-id="@proposal.Id"
                                       class="btn btn-sm btn-outline-secondary">
                                        Detalii
                                    </a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    }
</div>
